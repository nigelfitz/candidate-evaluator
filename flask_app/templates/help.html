{% extends "base.html" %}

{% block title %}Help & FAQ - Candidate Evaluator{% endblock %}

{% block content %}
<div class="help-container">
    <h1 style="margin-bottom: 1rem;">‚ùì Help & FAQ</h1>
    <p style="color: #666; margin-bottom: 1rem;">Everything you need to know about using Candidate Evaluator</p>
    
    <!-- Search Bar -->
    <div class="help-search-bar">
        <input type="text" id="helpSearch" placeholder="Search help topics..." onkeyup="filterHelpSections()">
    </div>
    
    <!-- Quick Start Guide -->
    <div class="help-section">
        <div class="section-header" onclick="toggleSection('quickstart')">
            <span class="section-icon">üöÄ</span>
            <h2>Quick Start Guide</h2>
            <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="section-content" id="quickstart">
            <h3>Getting Started in 5 Steps</h3>
            <ol class="guide-steps">
                <li>
                    <strong>Upload Job Description</strong>
                    <p>Go to "+ New Analysis" and upload your JD (PDF, DOCX, or TXT)</p>
                </li>
                <li>
                    <strong>Review Criteria</strong>
                    <p>The system extracts criteria automatically. Review and edit them on the "Job Criteria" page</p>
                </li>
                <li>
                    <strong>Upload Candidate Resumes</strong>
                    <p>Upload candidate Resumes/CVs (processing can get congested with too many, so we suggest 100 or fewer per batch.)</p>
                </li>
                <li>
                    <strong>Run Analysis</strong>
                    <p>"Analyse Candidates" to score all candidates against the criteria</p>
                </li>
                <li>
                    <strong>Review Results & Export</strong>
                    <p>View rankings and AI insights, and export reports</p>
                </li>
            </ol>
        </div>
    </div>
    
    <!-- Best Practices for Large Batches -->
    <div class="help-section">
        <div class="section-header" onclick="toggleSection('bestpractices')">
            <span class="section-icon">üí°</span>
            <h2>Best Practices for Large Batches</h2>
            <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="section-content" id="bestpractices">
            <h3>Handling Large Resume Uploads</h3>
            <p>
                When screening many candidates (100+), we recommend a strategic approach that gives you faster results, 
                better reliability, and more control over the hiring process.
            </p>
            
            <div class="best-practice-box">
                <h4>üéØ Recommended Strategy: Two-Pass Screening</h4>
                <p>This approach works whether you have all resumes at once, or applications arriving over time:</p>
                
                <ol class="guide-steps">
                    <li>
                        <strong>Process in smaller batches (50-100 resumes each)</strong>
                        <p>Break your candidates into manageable groups. This provides faster processing, more reliable results, 
                        and the ability to spot issues early. Each batch typically completes in 1-3 minutes.</p>
                    </li>
                    <li>
                        <strong>Identify top potential candidates from each batch</strong>
                        <p>Review the results from each batch and identify the strongest 5-10 candidates. Look for:
                        <ul>
                            <li>High overall scores (typically 0.65+)</li>
                            <li>Strong matches on your critical requirements</li>
                            <li>Candidates who stand out from the rest of their batch</li>
                        </ul>
                        </p>
                    </li>
                    <li>
                        <strong>Run one final comparison with only top candidates</strong>
                        <p>Once you've identified the strongest candidates from all batches, create a final job with just these 
                        finalists. This gives you a direct head-to-head comparison of your best candidates, making it easier to 
                        make your final hiring decision.</p>
                    </li>
                </ol>
            </div>
            
            <div class="example-box" style="margin-top: 1.5rem;">
                <h4>üìñ Example Scenario</h4>
                <p><strong>Situation:</strong> You have 300 applications for a Software Engineer role.</p>
                
                <p><strong>Approach:</strong></p>
                <ul>
                    <li><strong>Batch 1:</strong> Upload first 100 resumes ‚Üí Identify good potential candidates (e.g., 8 are worth further consideration)</li>
                    <li><strong>Batch 2:</strong> Use "Run New Batch with Same Criteria" button from Batch 1 results ‚Üí Upload next 100 resumes ‚Üí Identify promising candidates (e.g., 7 strong matches)</li>
                    <li><strong>Batch 3:</strong> Use "Run New Batch with Same Criteria" button again ‚Üí Upload final 100 resumes ‚Üí Identify top candidates (e.g., 10 standouts)</li>
                    <li><strong>Final Round:</strong> Upload just those 25 finalists ‚Üí Run detailed comparison</li>
                </ul>
                
                <p><strong>Result:</strong> You've efficiently narrowed 300 candidates down to your top 25, then performed a detailed 
                analysis on just the finalists who truly have potential.</p>
                
                <p style="margin-top: 1rem;"><strong>üí° Key Feature:</strong> The "Run New Batch with Same Criteria" button (found on any historical job's results page) 
                loads that job's exact criteria settings into your workspace. This ensures all batches are evaluated identically, making results directly comparable. 
                Remember to update the job title (e.g., add "Batch 2", "Batch 3") to keep your batches organized in Job History.</p>
            </div>
            
            <h3>Processing Applications as They Arrive</h3>
            <p>
                This same approach works brilliantly if you want to process applications progressively rather than waiting 
                for all resumes to arrive. Use the "Run New Batch with Same Criteria" feature to ensure consistent evaluation:
            </p>
            <ul>
                <li><strong>Week 1:</strong> Process your first 80 applications, get early insights into candidate quality</li>
                <li><strong>Week 2:</strong> Load Week 1 job using "Run New Batch with Same Criteria" ‚Üí Process the next batch that arrived, identify any standout candidates</li>
                <li><strong>Week 3:</strong> Load again with same criteria ‚Üí Process final batch after closing date</li>
                <li><strong>Final:</strong> Compare only the top candidates from each week</li>
            </ul>
            <p style="margin-top: 1rem; font-style: italic; color: #666;">
                <strong>Note:</strong> Using the batch feature ensures all weeks are evaluated with identical criteria, making scores directly comparable across time periods.
            </p>
            
            <div class="tip-box" style="margin-top: 1.5rem;">
                <h4>üí° Pro Tips</h4>
                <ul>
                    <li><strong>Use the batch feature:</strong> Click "Run New Batch with Same Criteria" on any historical job to load its exact criteria for new candidates‚Äîensures fair comparison across batches</li>
                    <li><strong>Early insights:</strong> Processing batches early gives you a "sneak peek" at application quality before all resumes arrive</li>
                    <li><strong>Adjust criteria:</strong> If early batches show unexpectedly low scores, you can refine your criteria before processing remaining candidates</li>
                    <li><strong>Reduce costs:</strong> Only pay for detailed AI insights on your finalists, not all 300 candidates</li>
                    <li><strong>Stay organized:</strong> Name your jobs clearly (e.g., "Software Engineer - Batch 1", "Software Engineer - Batch 2", "Software Engineer - Finalists")</li>
                </ul>
            </div>
            
            <h3>Why Not Process All at Once?</h3>
            <p>
                While the system can handle larger batches, breaking them up provides:
            </p>
            <ul>
                <li><strong>Faster results:</strong> Smaller batches complete in minutes instead of potentially timing out</li>
                <li><strong>Better reliability:</strong> Less chance of API rate limits or processing errors</li>
                <li><strong>Progressive insights:</strong> Start reviewing candidates while others are being processed</li>
                <li><strong>Easier management:</strong> Simpler to spot and fix any issues with specific candidates</li>
                <li><strong>Lower costs:</strong> Focus expensive AI insights on only the candidates who matter</li>
            </ul>
        </div>
    </div>
    
    <!-- Scoring Explained -->
    <div class="help-section">
        <div class="section-header" onclick="toggleSection('scoring')">
            <span class="section-icon">üìä</span>
            <h2>Scoring Explained</h2>
            <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="section-content" id="scoring">
            <h3>What do the scores mean?</h3>
            <p>
                Each score is a <strong>semantic similarity</strong> between a JD <strong>criterion</strong> and the 
                <strong>most relevant snippet</strong> in a candidate's resume. It ranges from <strong>0.00</strong> 
                (not similar) to <strong>1.00</strong> (nearly identical in meaning).
            </p>
            
            <div class="score-ranges">
                <div class="score-range high">
                    <div class="score-label">‚úÖ Strong (‚â•0.70)</div>
                    <div class="score-desc">Excellent to good alignment</div>
                </div>
                <div class="score-range medium">
                    <div class="score-label">‚ö†Ô∏è Moderate (0.45‚Äì0.70)</div>
                    <div class="score-desc">Partial or indirect match</div>
                </div>
                <div class="score-range low">
                    <div class="score-label">‚õî Weak (<0.45)</div>
                    <div class="score-desc">Likely not covered</div>
                </div>
            </div>
            
            <h3>Quick Reference Ranges</h3>
            <ul>
                <li><strong>0.75‚Äì1.00:</strong> Excellent alignment</li>
                <li><strong>0.60‚Äì0.74:</strong> Good</li>
                <li><strong>0.45‚Äì0.59:</strong> Moderate (partial/indirect)</li>
                <li><strong>0.30‚Äì0.44:</strong> Weak</li>
                <li><strong>&lt;0.30:</strong> Likely not covered</li>
            </ul>
            
            <p><strong>Overall</strong> is a weighted average of all criteria scores.</p>
            
            <h3>How it's calculated (plain English)</h3>
            <ol>
                <li>The resume is split into chunks (approximately 1,200 characters each)</li>
                <li>For each <strong>criterion</strong>, we compare it to every chunk and keep the <strong>best match</strong></li>
                <li>The similarity comes from vector math (cosine similarity on embeddings), which captures meaning overlap, not just exact words</li>
            </ol>
            
            <h3>Examples</h3>
            <div class="example-box">
                <p><strong>Criterion:</strong> "Project management with Agile/Scrum"</p>
                <p><strong>Resume:</strong> "Led a 10-person team delivering sprints using Scrum ceremonies"</p>
                <p class="score-result">‚Üí Score <span class="score-tag score-tag-high">0.75‚Äì0.85</span> (strong, direct alignment)</p>
            </div>
            
            <div class="example-box">
                <p><strong>Criterion:</strong> "Python data analysis"</p>
                <p><strong>Resume:</strong> "Automated Excel reports; some VBA macros"</p>
                <p class="score-result">‚Üí Score <span class="score-tag score-tag-medium">0.35‚Äì0.50</span> (partial/weak ‚Äî tooling mismatch)</p>
            </div>
            
            <h3>How to use the scores</h3>
            <ul>
                <li>Treat scores as <strong>evidence strength</strong>, not pass/fail</li>
                <li>Use the Coverage matrix to spot strengths and gaps</li>
                <li>Use the Evidence Explorer to view exact resume snippets behind each score</li>
                <li>Adjust scoring thresholds in <a href="{{ url_for('settings') }}">Settings</a> if you want stricter or more lenient classifications</li>
            </ul>
        </div>
    </div>
    
    <!-- Privacy & Data Handling -->
    <div class="help-section">
        <div class="section-header" onclick="toggleSection('privacy')">
            <span class="section-icon">üîí</span>
            <h2>Privacy & Data Handling</h2>
            <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="section-content" id="privacy">
            <h3>How your data is handled</h3>
            <p>This application uses OpenAI's <strong>GPT-4o</strong> model for intelligent analysis of job descriptions and candidate resumes.</p>
            
            <div class="info-box success">
                <h4>‚úÖ Your data is NOT used to train AI models</h4>
                <p>OpenAI does not use data submitted via their API to train or improve their models (unless you explicitly opt in). We have NOT opted in to any training programs.</p>
            </div>
            
            <div class="info-box success">
                <h4>‚úÖ Limited data retention</h4>
                <p>API data is retained by OpenAI for up to <strong>30 days</strong> for abuse and misuse monitoring. After 30 days, your data is automatically deleted from OpenAI's servers.</p>
            </div>
            
            <div class="info-box success">
                <h4>‚úÖ Secure transmission</h4>
                <p>All data is transmitted securely via HTTPS to OpenAI's API endpoints. No data is stored on external servers by this application.</p>
            </div>
            
            <div class="info-box warning">
                <h4>‚ö†Ô∏è What this means for you</h4>
                <ul>
                    <li>Job descriptions and resumes are temporarily processed by OpenAI's systems</li>
                    <li>If your organization has strict data privacy requirements, consult your compliance team before use</li>
                    <li>If this data handling is unacceptable for your use case, do not use this application</li>
                </ul>
            </div>
            
            <h3>üìö Learn more</h3>
            <ul>
                <li><a href="https://openai.com/policies/api-data-usage-policies" target="_blank">OpenAI API Data Usage Policies</a></li>
                <li><a href="https://openai.com/enterprise-privacy" target="_blank">OpenAI Enterprise Privacy</a></li>
            </ul>
        </div>
    </div>
    
    <!-- Frequently Asked Questions -->
    <div class="help-section">
        <div class="section-header" onclick="toggleSection('faq')">
            <span class="section-icon">üí¨</span>
            <h2>Frequently Asked Questions</h2>
            <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="section-content" id="faq">
            <div class="faq-item">
                <h3 class="faq-q">How does Candidate Evaluator work?</h3>
                <p class="faq-a">Upload your job description and candidate CVs. The app scores each candidate against extracted criteria, then (optionally) generates AI-powered insights for your top picks.</p>
            </div>
            
            <div class="faq-item">
                <h3 class="faq-q">How much does it cost?</h3>
                <p class="faq-a">Candidate Evaluator works on a simple pay-as-you-go model. Your first job is on us! After that, it is <strong>$10 per job</strong>, which includes a full ranked leaderboard of all your candidates and <strong>5 deep-dive AI insights</strong>. If you need more insights, you can unlock them for <strong>$1.00 each</strong> from your account wallet. No monthly fees, no hidden costs.</p>
            </div>
            
            <div class="faq-item">
                <h3 class="faq-q">How accurate is the scoring?</h3>
                <p class="faq-a">Scores measure <strong>semantic similarity</strong> based on text analysis. They are good at identifying relevant experience, skills, and qualifications, but not perfect at understanding context or verifying claims. <strong>Best practice:</strong> Use scores as a screening tool to identify strong candidates, then conduct interviews to verify fit.</p>
            </div>
            
            <div class="faq-item">
                <h3 class="faq-q">Can I edit criteria?</h3>
                <p class="faq-a">Yes! Visit the "Job Criteria" page to review and edit extracted criteria. You can add, remove, or modify criteria before running analysis.</p>
            </div>
            
            <div class="faq-item">
                <h3 class="faq-q">What file formats are supported?</h3>
                <p class="faq-a">
                    <strong>Job Descriptions:</strong> PDF, DOCX, DOC, TXT<br>
                    <strong>Resumes:</strong> PDF, DOCX, DOC, TXT<br>
                    All files are converted to text for analysis.
                </p>
            </div>
            
            <div class="faq-item">
                <h3 class="faq-q">How do I export results?</h3>
                <p class="faq-a">After running analysis, click "Export Reports" to download executive summaries, coverage matrices (Excel/CSV), and individual candidate reports (PDF/Word).</p>
            </div>
            
            <div class="faq-item">
                <h3 class="faq-q">Can I revisit past analyses?</h3>
                <p class="faq-a">Yes! All analyses are saved to your account. Visit the "History" page to view and reopen past jobs.</p>
            </div>
            
            <div class="faq-item">
                <h3 class="faq-q">What happens to my data after I log out?</h3>
                <p class="faq-a">Your analyses and settings are securely stored in your account so you can access them anytime. Your job descriptions and candidate resumes remain in your account until you choose to delete them. When documents are processed, OpenAI retains API request data for 30 days for abuse monitoring purposes only, then automatically deletes it. OpenAI does not use your data to train AI models.</p>
            </div>
        </div>
    </div>
    
    <!-- Troubleshooting -->
    <div class="help-section">
        <div class="section-header" onclick="toggleSection('troubleshooting')">
            <span class="section-icon">üîß</span>
            <h2>Troubleshooting</h2>
            <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="section-content" id="troubleshooting">
            <h3>Analysis not running</h3>
            <ul>
                <li>Ensure you've uploaded both a Job Description and at least one candidate resume</li>
                <li>Check that criteria have been extracted (visible on Job Criteria page)</li>
                <li>Verify you have sufficient account balance</li>
            </ul>
            
            <h3>PDF text extraction issues</h3>
            <ul>
                <li>Some PDFs (especially scanned documents) may not extract text properly</li>
                <li>Try re-saving the PDF or converting it to DOCX format</li>
                <li>Very complex multi-column layouts may extract better as DOCX</li>
            </ul>
            
            <h3>Scores seem too low/high</h3>
            <ul>
                <li>Review criteria on Job Criteria page - overly specific criteria may score lower</li>
                <li>Check the Evidence Explorer to see what text is being matched</li>
            </ul>
            

        </div>
    </div>
    
    <!-- Contact & Support -->
    <div class="help-section">
        <div class="section-header" onclick="toggleSection('contact')">
            <span class="section-icon">üìß</span>
            <h2>Contact & Support</h2>
            <span class="toggle-icon">‚ñº</span>
        </div>
        <div class="section-content" id="contact">
            <h3>Need more help?</h3>
            <p>If you have questions not covered in this FAQ, please contact:</p>
            <p><strong>Email:</strong> support@candidateevaluator.com</p>
            
            <h3>About This Application</h3>
            <p><strong>Version:</strong> 2.0 (December 2025)</p>
            <p><strong>Technology:</strong></p>
            <ul>
                <li><strong>AI Model:</strong> OpenAI GPT-4o</li>
                <li><strong>Embeddings:</strong> Sentence transformers for semantic similarity</li>
                <li><strong>Framework:</strong> Flask (Python)</li>
            </ul>
        </div>
    </div>
</div>

<style>
    .help-container {
        max-width: 1000px;
        margin: 2rem auto;
        padding: 0 1rem;
    }
    
    .help-search-bar {
        margin-bottom: 2rem;
    }
    
    .help-search-bar input {
        width: 100%;
        padding: 0.8rem 1rem;
        font-size: 1rem;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        transition: all 0.3s;
    }
    
    .help-search-bar input:focus {
        outline: none;
        border-color: #1f77b4;
        box-shadow: 0 0 0 3px rgba(31, 119, 180, 0.1);
    }
    
    .score-tag {
        display: inline-block;
        padding: 0.2rem 0.6rem;
        border-radius: 4px;
        font-weight: 600;
        font-size: 0.9rem;
        color: white;
    }
    
    .score-tag-high {
        background-color: #16a34a;
    }
    
    .score-tag-medium {
        background-color: #eab308;
        color: #333;
    }
    
    .score-tag-low {
        background-color: #dc2626;
    }
    
    .help-section {
        background: white;
        border-radius: 8px;
        margin-bottom: 1rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        overflow: hidden;
    }
    
    .section-header {
        display: flex;
        align-items: center;
        padding: 1.5rem;
        cursor: pointer;
        background: linear-gradient(135deg, #1f77b4 0%, #155a8a 100%);
        color: white;
        transition: background 0.3s;
    }
    
    .section-header:hover {
        background: linear-gradient(135deg, #155a8a 0%, #1f77b4 100%);
    }
    
    .section-icon {
        font-size: 1.8rem;
        margin-right: 1rem;
    }
    
    .section-header h2 {
        flex: 1;
        margin: 0;
        font-size: 1.3rem;
        font-weight: 600;
    }
    
    .toggle-icon {
        font-size: 1.2rem;
        transition: transform 0.3s;
    }
    
    .section-header.active .toggle-icon {
        transform: rotate(180deg);
    }
    
    .section-content {
        padding: 2rem;
        display: none;
    }
    
    .section-content.active {
        display: block;
    }
    
    .section-content h3 {
        color: #1f77b4;
        margin-top: 1.5rem;
        margin-bottom: 0.8rem;
        font-size: 1.1rem;
    }
    
    .section-content h3:first-child {
        margin-top: 0;
    }
    
    .guide-steps {
        list-style: none;
        counter-reset: step-counter;
        padding-left: 0;
    }
    
    .guide-steps li {
        counter-increment: step-counter;
        position: relative;
        padding-left: 3rem;
        margin-bottom: 1.5rem;
    }
    
    .guide-steps li::before {
        content: counter(step-counter);
        position: absolute;
        left: 0;
        top: 0;
        width: 2rem;
        height: 2rem;
        background: #1f77b4;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
    }
    
    .guide-steps li strong {
        display: block;
        color: #333;
        margin-bottom: 0.3rem;
    }
    
    .guide-steps li p {
        margin: 0;
        color: #666;
    }
    
    .score-ranges {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin: 1.5rem 0;
    }
    
    .score-range {
        padding: 1rem;
        border-radius: 6px;
        border-left: 4px solid;
    }
    
    .score-range.high {
        background: #e8f5e9;
        border-color: #28a745;
    }
    
    .score-range.medium {
        background: #fff3e0;
        border-color: #ffc107;
    }
    
    .score-range.low {
        background: #ffebee;
        border-color: #dc3545;
    }
    
    .score-label {
        font-weight: 600;
        font-size: 1.1rem;
        margin-bottom: 0.3rem;
    }
    
    .score-desc {
        color: #666;
        font-size: 0.9rem;
    }
    
    .example-box {
        background: #f8f9fa;
        padding: 1rem;
        border-left: 3px solid #1f77b4;
        margin: 1rem 0;
    }
    
    .example-box p {
        margin: 0.5rem 0;
    }
    
    .best-practice-box {
        background: #f0f9ff;
        padding: 1.5rem;
        border-left: 4px solid #3b82f6;
        border-radius: 8px;
        margin: 1rem 0;
    }
    
    .best-practice-box h4 {
        color: #1e40af;
        margin-top: 0;
        margin-bottom: 1rem;
    }
    
    .tip-box {
        background: #fefce8;
        padding: 1.5rem;
        border-left: 4px solid #eab308;
        border-radius: 8px;
        margin: 1rem 0;
    }
    
    .tip-box h4 {
        color: #78350f;
        margin-top: 0;
        margin-bottom: 1rem;
    }
    
    .score-result {
        color: #1f77b4;
        font-weight: 600;
        margin-top: 0.5rem !important;
    }
    
    .info-box {
        padding: 1.2rem;
        border-radius: 6px;
        margin: 1rem 0;
        border-left: 4px solid;
    }
    
    .info-box.success {
        background: #e8f5e9;
        border-color: #28a745;
    }
    
    .info-box.warning {
        background: #fff3e0;
        border-color: #ffc107;
    }
    
    .info-box h4 {
        margin: 0 0 0.5rem 0;
        color: #333;
        font-size: 1rem;
    }
    
    .info-box p, .info-box ul {
        margin: 0.5rem 0 0 0;
        color: #666;
    }
    
    .info-box ul {
        padding-left: 1.5rem;
    }
    
    .faq-item {
        margin-bottom: 1.5rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid #e0e0e0;
    }
    
    .faq-item:last-child {
        border-bottom: none;
    }
    
    .faq-q {
        color: #1f77b4;
        font-size: 1.05rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    
    .faq-a {
        color: #666;
        line-height: 1.6;
        margin: 0;
    }
    
    a {
        color: #1f77b4;
        text-decoration: none;
    }
    
    a:hover {
        text-decoration: underline;
    }
</style>

<script>
function toggleSection(sectionId) {
    const content = document.getElementById(sectionId);
    const header = content.previousElementSibling;
    
    if (content.classList.contains('active')) {
        content.classList.remove('active');
        header.classList.remove('active');
    } else {
        content.classList.add('active');
        header.classList.add('active');
    }
}

function filterHelpSections() {
    const searchTerm = document.getElementById('helpSearch').value.toLowerCase();
    const sections = document.querySelectorAll('.help-section');
    
    sections.forEach(section => {
        const header = section.querySelector('.section-header h2').textContent.toLowerCase();
        const content = section.querySelector('.section-content').textContent.toLowerCase();
        
        if (header.includes(searchTerm) || content.includes(searchTerm) || searchTerm === '') {
            section.style.display = 'block';
        } else {
            section.style.display = 'none';
        }
    });
}
</script>
{% endblock %}
